{"version":3,"sources":["bundle.min.js","app.js","foodService.js","lessons.js","localStorage.js","myDate.js","date.js","ngLastRepeat.js","timeRange.js","lessonController.js","lukkariController.js","lunchController.js","searchController.js","settingsController.js","todayController.js","weekController.js"],"names":["angular","module","run","$ionicPlatform","ready","window","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","disableScroll","StatusBar","styleDefault","constant","url","config","$stateProvider","$urlRouterProvider","state","abstract","templateUrl","controller","views","menuContent","otherwise","loadingTemplate","factory","$http","LunchEndPoint","ngXml2json","parseLunch","element","index","array","i","lunch","date","Date","div","span","content","dishes","length","dish","pricegroups","allergies","name","ul","li","includes","push","lunches","get","_ref","callback","method","then","response","data","query","results","forEach","ApiEndpoint","MyDate","parseLesson","lesson","id","startDay","startDate","endDay","endDate","groups","resources","resource","type","code","room","roomInfo","parent","lessons","studentGroup","savedGroupName","apiKey","withCredentials","headers","authorization","accept-language","content-type","cache-control","success","status","console","log","reservations","error","changeGroup","groupName","toUpperCase","result","getDay","_ref2","day","dayLessons","getDate","getMonth","getWeek","_ref3","weekLessons","getFullYear","getDayFromDay","currentDay","offsetDays","getDayToDay","_ref4","correctEndDate","retLessons","getLesson","localStorage","getItem","set","value","setItem","getMonday","d","diff","setDate","getLocaleDate","years","options","month","year","Intl","DateTimeFormat","format","getTime","DAY_IN_MILLISECONDS","setTime","getDayFromToday","now","directive","template","$timeout","restrict","link","scope","attr","$last","$emit","ngLastRepeat","$scope","$ionicLoading","$stateParams","Lessons","ionicMaterialInk","ionicMaterialMotion","FoodService","show","hide","$on","e","ripple","displayEffect","LocalStorage","$cordovaToast","$cordovaCalendar","datePickerCallback","val","reminder","datepickerObject","inputDate","datePickerCallback2","datepickerObject2","groupInfo","toastOptions","duration","position","titleLabel","todayLabel","closeLabel","setLabel","setButtonType","todayButtonType","closeButtonType","mondayFirst","templateType","showTodayButton","modalHeaderColor","modalFooterColor","from","dateFormat","closeOnSelect","time","group","location","href","addToCalendar","createEvent","createEventWithOptions","title","notes","teacher","firstReminderMinutes","calOptions","secondReminderMinutes","calendarName","calendarId","err","msg","$ionicModal","getAppointments","fromTemplateUrl","modal","closeGroupName","blinds","setGroup","undefined","moveDay","direction","currentDate","allLessons","days","lessonsLength","j","toDateString","moveWeek"],"mappings":"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","file":"bundle.min.js","sourcesContent":["'use strict';\n\nangular.module('lukkari', ['ionic', 'lukkari.controllers', 'lukkari.services', 'lukkari.directives', 'ionic-datepicker', 'ionic-material', 'angularXml2json']).run(['$ionicPlatform', function ($ionicPlatform) {\n  $ionicPlatform.ready(function () {\n    // Hide the accessory bar by default (remove this to show the accessory bar above the keyboard\n    // for form inputs)\n    if (window.cordova && window.cordova.plugins.Keyboard) {\n      cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);\n      cordova.plugins.Keyboard.disableScroll(true);\n    }\n    if (window.StatusBar) {\n      // org.apache.cordova.statusbar required\n      StatusBar.styleDefault();\n    }\n  });\n}])\n\n// http://blog.ionic.io/handling-cors-issues-in-ionic/\n.constant('ApiEndpoint', {\n  url: 'http://localhost:8100/api'\n}).constant('LunchEndPoint', {\n  url: 'http://localhost:8100/lunch'\n})\n\n// menuContent-view is presented on the main view.\n.config(['$stateProvider', '$urlRouterProvider', function ($stateProvider, $urlRouterProvider) {\n  $stateProvider.state('app', {\n    url: '/app',\n    abstract: true,\n    templateUrl: 'templates/menu.html',\n    controller: 'LukkariCtrl'\n  }).state('app.search', {\n    url: '/search',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/search.html',\n        controller: 'SearchCtrl'\n      }\n    }\n  }).state('app.settings', {\n    url: '/settings',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/settings.html',\n        controller: 'SettingsCtrl'\n      }\n    }\n  }).state('app.todayLesson', {\n    url: '/today/:id',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/lesson.html',\n        controller: 'LessonCtrl'\n      }\n    }\n  }).state('app.today', {\n    url: '/today',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/today.html',\n        controller: 'TodayCtrl'\n      }\n    }\n  }).state('app.lesson', {\n    url: '/week/:id',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/lesson.html',\n        controller: 'LessonCtrl'\n      }\n    }\n  }).state('app.week', {\n    url: '/week',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/week.html',\n        controller: 'WeekCtrl'\n      }\n    }\n  }).state('app.lunch', {\n    url: '/lunch',\n    views: {\n      'menuContent': {\n        templateUrl: 'templates/lunch.html',\n        controller: 'LunchCtrl'\n      }\n    }\n  });\n  // if none of the above states are matched, use this as the fallback\n  $urlRouterProvider.otherwise('/app/today');\n}]);\n\nangular.module('lukkari.services', []);\nangular.module('lukkari.controllers', ['ngCordova']);\nvar loadingTemplate = '<div class=\"loader\"><svg class=\"circular\">' + '<circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\"' + ' stroke-miterlimit=\"10\"/></svg></div>';\nangular.module('lukkari.directives', []);\n'use strict';\n\nangular.module('lukkari.services').factory('FoodService', ['$http', 'LunchEndPoint', 'ngXml2json', function ($http, LunchEndPoint, ngXml2json) {\n  var lunches = [];\n\n  function parseLunch(element, index, array) {\n    var i;\n    var j;\n    var lunch = {};\n    // get date\n    lunch.date = new Date(element.div[0].span.content[0]);\n    // get dishes\n    lunch.dishes = [];\n    // remove 3 from length to ignore evening foods\n    var length = element.div[1].div.length - 3;\n    for (i = 0; i < length; i++) {\n      var dish = {};\n      dish.pricegroups = [];\n      dish.allergies = [];\n      dish.name = element.div[1].div[i].div.div.ul.li.div.div.div[0].div.div.content;\n      if (dish.name.includes('Ravintola avoinna')) {\n        continue;\n      }\n      // get pricing info\n      // var length2;\n      // try {\n      //   length2 = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\n      //     .div.div.div.length;\n      // } catch (e) {\n      //   length2 = 0;\n      // }\n      //\n      // for (j = 0; j < length2; j++) {\n      //   var pricegroup = {};\n      //   try {\n      //     pricegroup.group = element.div[1].div[i].div.div.ul.li.div.div.div[\n      //       1].div.div.div.div[j].div[0].div.div.p;\n      //   } catch (e) {\n      //     pricegroup.group = 'N/A';\n      //   }\n      //   try {\n      //     pricegroup.price = element.div[1].div[i].div.div.ul.li.div.div.div[\n      //       1].div.div.div.div[j].div[1].div.div.content;\n      //   } catch (e) {\n      //     pricegroup.price = '';\n      //   }\n      //\n      //   dish.pricegroups.push(pricegroup);\n      // }\n      // // var pricegroup = {};\n      // // pricegroup.group = element.div[1].div[i].div.div.ul.li.div.div.div[\n      // //   1].div.div.div.div[j].div.div.div.p;\n      // // pricegroup.price = element.div[1].div[i].div.div.ul.li.div.div.div[\n      // //   1].div.div.div.div[j].div.div.div.p;\n      //\n      // // get allergy info\n      // var length3 = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\n      //   .div.length;\n      // for (j = 0; j < length3; j++) {\n      //   var allergy = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\n      //     .div[j].div.div[0].div.div.p;\n      //   dish.allergies.push(allergy);\n      // }\n      lunch.dishes.push(dish);\n    }\n    lunches.push(lunch);\n  }\n\n  function get(_ref) {\n    var callback = _ref.callback;\n\n    if (lunches.length > 0) {\n      callback(lunches);\n    } else {\n      $http({\n        method: 'GET',\n        url: \"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fcampusravita.fi%2Fruokalista%22%20and%0A%20%20%20%20%20%20xpath%3D'%2F%2Fdiv%5B%40class%3D%22view-grouping%22%5D'&format=json&diagnostics=true&callback=\"\n      }).then(function successCallback(response) {\n        var data = response.data.query.results.div;\n        data.forEach(parseLunch);\n        callback(lunches);\n      }, function errorCallback(response) {});\n    }\n  }\n\n  return {\n    get: get\n  };\n}]);\n'use strict';\n\nangular.module('lukkari.services').factory('Lessons', ['$http', 'ApiEndpoint', 'MyDate', function ($http, ApiEndpoint, MyDate) {\n  var lessons = [];\n  var savedGroupName = '';\n\n  function parseLesson(element, index, array) {\n    var lesson = {};\n    lesson.id = index;\n    lesson.startDay = new Date(element.startDate);\n    lesson.endDay = new Date(element.endDate);\n    lesson.groups = [];\n    // parse the resources array\n    var resources = element.resources;\n\n    resources.forEach(function (resource, index, array) {\n      switch (resource.type) {\n        case 'realization':\n          lesson.code = resource.code;\n          lesson.name = resource.name;\n          break;\n        case 'room':\n          lesson.room = resource.code;\n          lesson.roomInfo = resource.parent.name;\n          break;\n        case 'student_group':\n          lesson.groups.push(resource.code);\n          break;\n      }\n    });\n    lessons.push(lesson);\n  }\n\n  function get(callback) {\n    var data = {\n      studentGroup: [savedGroupName]\n    };\n    var apiKey = 'Wu47zzKEPa7agvin47f5';\n    var url = ApiEndpoint.url + '/reservation/search' + '?apiKey=' + apiKey;\n    $http({\n      method: 'POST',\n      url: url,\n      data: data,\n      withCredentials: true,\n      headers: {\n        'authorization': 'Basic V3U0N3p6S0VQYTdhZ3ZpbjQ3ZjU6',\n        'accept-language': 'fi',\n        'content-type': 'application/json',\n        'cache-control': 'no-cache'\n      }\n    }).success(function (data, status, headers, config) {\n      console.log('success');\n      lessons = [];\n      data.reservations.forEach(parseLesson);\n      callback({\n        success: false\n      });\n    }).error(function (data, status, headers, config) {\n      console.log('failure');\n      callback({\n        success: false\n      });\n    });\n  }\n\n  // private get method that just saves lessons\n  // change group name method that changes group anme and uses private get method\n  function changeGroup(_ref) {\n    var groupName = _ref.groupName;\n    var callback = _ref.callback;\n\n    savedGroupName = groupName.toUpperCase();\n    get(function (result) {\n      callback(result);\n    });\n  }\n\n  // get day method that returns one day's lessons using date\n  function getDay(_ref2) {\n    var callback = _ref2.callback;\n    var day = _ref2.day;\n\n    if (!day || !day instanceof Date) {\n      console.error('Error in date!');\n      callback({\n        success: false\n      });\n    } else {\n      var dayLessons = [];\n      lessons.forEach(function (lesson, index, array) {\n        var date = lesson.startDay;\n        if (date.getDate() === day.getDate() && date.getMonth() === day.getMonth()) {\n          dayLessons.push(lesson);\n        }\n      });\n      callback({\n        success: true,\n        dayLessons: dayLessons\n      });\n    }\n  }\n\n  // get week method that returns one week's lessons using startDate and week offset\n  function getWeek(_ref3) {\n    var callback = _ref3.callback;\n    var day = _ref3.day;\n\n    var weekLessons = [];\n    var startDate = new Date(day.getFullYear(), day.getMonth(), day.getDate());\n    var endDate = MyDate.getDayFromDay({\n      currentDay: day,\n      offsetDays: 5\n    });\n    lessons.forEach(function (lesson, index, array) {\n      if (lesson.startDay >= startDate && lesson.startDay <= endDate) {\n        weekLessons.push(lesson);\n      }\n    });\n    callback({\n      success: true,\n      weekLessons: weekLessons\n    });\n  }\n\n  //get day to day method that returns all appointments from day a to day b\n  function getDayToDay(_ref4) {\n    var callback = _ref4.callback;\n    var startDate = _ref4.startDate;\n    var endDate = _ref4.endDate;\n\n    var correctEndDate = MyDate.getDayFromDay({\n      currentDay: endDate,\n      offsetDays: 1\n    });\n    var retLessons = [];\n    lessons.forEach(function (lesson, index, array) {\n      if (lesson.startDay >= startDate && lesson.startDay <= correctEndDate) {\n        retLessons.push(lesson);\n      }\n    });\n    callback({\n      success: true,\n      lessons: retLessons\n    });\n  }\n\n  function getLesson(id) {\n    return lessons[id];\n  }\n\n  return {\n    changeGroup: changeGroup,\n    getDay: getDay,\n    getWeek: getWeek,\n    getDayToDay: getDayToDay,\n    getLesson: getLesson\n  };\n}]);\n'use strict';\n\nangular.module('lukkari.services').factory('LocalStorage', [function () {\n  function get(name) {\n    return window.localStorage.getItem(name);\n  }\n\n  function set(name, value) {\n    return window.localStorage.setItem(name, value);\n  }\n\n  return {\n    get: get,\n    set: set\n  };\n}]);\n'use strict';\n\nangular.module('lukkari.services').factory('MyDate', [function () {\n  var DAY_IN_MILLISECONDS = 86400000;\n\n  // returns the monday of the week date object of the given date\n  function getMonday(d) {\n    d = new Date(d);\n    var day = d.getDay();\n    var diff = d.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\n    return new Date(d.setDate(diff));\n  }\n\n  function getLocaleDate(_ref) {\n    var day = _ref.day;\n    var years = _ref.years;\n\n    var options = {\n      //weekday: 'long',\n      month: 'numeric',\n      day: 'numeric'\n    };\n    if (typeof years === 'boolean' && years) {\n      options.year = 'numeric';\n    }\n    return new Intl.DateTimeFormat('fi-FI', options).format(day);\n  }\n\n  function getDayFromDay(_ref2) {\n    var currentDay = _ref2.currentDay;\n    var offsetDays = _ref2.offsetDays;\n\n    var day = currentDay.getTime();\n    // add desired amount of days to the millisecs\n    day += offsetDays * DAY_IN_MILLISECONDS;\n    // create Date object and set it's time to the millisecs\n    var date = new Date();\n    date.setTime(day);\n    return date;\n  }\n\n  // returns a day that is offset from today\n  function getDayFromToday(offsetDays) {\n    // today in millisecs since the beginning of time (UNIX time)\n    var day = Date.now();\n    // add desired amount of days to the millisecs\n    day += offsetDays * DAY_IN_MILLISECONDS;\n    // create Date object and set it's time to the millisecs\n    return new Date(day);\n  }\n\n  return {\n    getMonday: getMonday,\n    getDayFromToday: getDayFromToday,\n    getLocaleDate: getLocaleDate,\n    getDayFromDay: getDayFromDay\n  };\n}]);\n'use strict';\n\nangular.module('lukkari.directives').directive('date', function () {\n  return {\n    template: '{{day.date.toLocaleDateString(\"fi-FI\",' + ' {weekday: \"short\", day: \"numeric\", month:\"numeric\"})}}'\n  };\n});\n'use strict';\n\nangular.module('lukkari.directives').directive('ngLastRepeat', function ($timeout) {\n  return {\n    restrict: 'A',\n    link: function link(scope, element, attr) {\n      if (scope.$last === true) {\n        $timeout(function () {\n          scope.$emit('ngLastRepeat' + (attr.ngLastRepeat ? '.' + attr.ngLastRepeat : ''));\n        });\n      }\n    }\n  };\n});\n'use strict';\n\nangular.module('lukkari.directives').directive('timeRange', function () {\n  return {\n    template: '{{lesson.startDay.toLocaleTimeString' + '(\"fi-FI\", {hour:\"numeric\", minute:\"numeric\"})}}' + ' â€” ' + '{{lesson.endDay.toLocaleTimeString' + '(\"fi-FI\", {hour:\"numeric\", minute:\"numeric\"})}}'\n  };\n});\n'use strict';\n\nangular.module('lukkari.controllers')\n// controller for single appointment view\n.controller('LessonCtrl', ['$scope', '$ionicLoading', '$stateParams', 'Lessons', 'ionicMaterialInk', 'ionicMaterialMotion', function ($scope, $ionicLoading, $stateParams, Lessons, ionicMaterialInk, ionicMaterialMotion) {\n  $scope.lesson = Lessons.getLesson($stateParams.id);\n}]);\n'use strict';\n\nangular.module('lukkari.controllers').controller('LukkariCtrl', ['$scope', function ($scope) {}]);\n'use strict';\n\nangular.module('lukkari.controllers').controller('LunchCtrl', ['$scope', 'FoodService', 'ionicMaterialInk', 'ionicMaterialMotion', '$ionicLoading', function ($scope, FoodService, ionicMaterialInk, ionicMaterialMotion, $ionicLoading) {\n  $ionicLoading.show({\n    template: '<div class=\"loader\"><svg class=\"circular\"><circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"/></svg></div>'\n  });\n  FoodService.get({\n    callback: function callback(lunches) {\n      $scope.lunches = lunches;\n      $ionicLoading.hide();\n    }\n  });\n\n  $scope.$on('ngLastRepeat.myList', function (e) {\n    ionicMaterialMotion.ripple();\n  });\n\n  // Set Ink\n  ionicMaterialInk.displayEffect();\n}]);\n'use strict';\n\nangular.module('lukkari.controllers')\n// TODO\n.controller('SearchCtrl', ['$scope', 'LocalStorage', function ($scope, LocalStorage) {}]);\n'use strict';\n\nangular.module('lukkari.controllers').controller('SettingsCtrl', ['$scope', 'LocalStorage', '$cordovaToast', '$ionicPlatform', '$timeout', '$cordovaCalendar', 'Lessons', 'MyDate', 'ionicMaterialInk', 'ionicMaterialMotion', function ($scope, LocalStorage, $cordovaToast, $ionicPlatform, $timeout, $cordovaCalendar, Lessons, MyDate, ionicMaterialInk, ionicMaterialMotion) {\n  $scope.groupInfo = {};\n  $scope.reminder = {};\n  $scope.reminder.startDay = new Date();\n  $scope.reminder.endDay = new Date();\n\n  var toastOptions = {\n    duration: 'long',\n    position: 'center'\n  };\n\n  function datePickerCallback(val) {\n    if (typeof val === 'undefined') {\n      //console.log('No date selected');\n    } else {\n        //console.log('Selected date is : ', val);\n        $scope.reminder.startDay = val;\n        $scope.datepickerObject.inputDate = val;\n      }\n  }\n\n  function datePickerCallback2(val) {\n    if (typeof val === 'undefined') {\n      //console.log('No date selected');\n    } else {\n        //console.log('Selected date is : ', val);\n        $scope.reminder.endDay = val;\n        $scope.datepickerObject2.inputDate = val;\n      }\n  }\n\n  // https://github.com/rajeshwarpatlolla/ionic-datepicker\n  $scope.datepickerObject = {\n    titleLabel: 'Select Start Date', //Optional\n    todayLabel: 'Today', //Optional\n    closeLabel: '<span class=\"icon ion-android-close\"></span>', //Optional\n    setLabel: '<span class=\"icon ion-android-done\"></span>', //Optional\n    setButtonType: 'button-positive', //Optional\n    todayButtonType: 'button-stable', //Optional\n    closeButtonType: 'button-assertive', //Optional\n    inputDate: $scope.reminder.startDay, //Optional\n    mondayFirst: true, //Optional\n    //disabledDates: disabledDates, //Optional\n    //weekDaysList: weekDaysList, //Optional\n    //monthList: monthList, //Optional\n    templateType: 'popup', //Optional\n    showTodayButton: 'true', //Optional\n    modalHeaderColor: 'bar-stable', //Optional\n    modalFooterColor: 'bar-stable', //Optional\n    from: new Date(), //Optional\n    //to: new Date(2018, 8, 25), //Optional\n    callback: function callback(val) {\n      //Mandatory\n      datePickerCallback(val);\n    },\n    dateFormat: 'dd-MM-yyyy', //Optional\n    closeOnSelect: true };\n\n  //Optional\n  $scope.datepickerObject2 = {\n    titleLabel: 'Select End Date', //Optional\n    todayLabel: 'Today', //Optional\n    closeLabel: '<span class=\"icon ion-android-close\"></span>', //Optional\n    setLabel: '<span class=\"icon ion-android-done\"></span>', //Optional\n    setButtonType: 'button-positive', //Optional\n    todayButtonType: 'button-stable', //Optional\n    closeButtonType: 'button-assertive', //Optional\n    inputDate: $scope.reminder.endDay, //Optional\n    mondayFirst: true, //Optional\n    //disabledDates: disabledDates, //Optional\n    //weekDaysList: weekDaysList, //Optional\n    //monthList: monthList, //Optional\n    templateType: 'popup', //Optional\n    showTodayButton: false, //Optional\n    modalHeaderColor: 'bar-positive', //Optional\n    modalFooterColor: 'bar-positive', //Optional\n    from: new Date(), //Optional\n    //to: new Date(2018, 8, 25), //Optional\n    callback: function callback(val) {\n      //Mandatory\n      datePickerCallback2(val);\n    },\n    dateFormat: 'dd-MM-yyyy', //Optional\n    closeOnSelect: true };\n\n  //Optional\n  $scope.reminder.time = 'null';\n  $scope.groupInfo.group = LocalStorage.get('groupName');\n  if (!$scope.groupInfo.group) {\n    $scope.groupInfo.group = '';\n  }\n\n  $scope.changeGroup = function () {\n    LocalStorage.set('groupName', $scope.groupInfo.group);\n    // show toast that change was successful\n    $ionicPlatform.ready(function () {\n      try {\n        $cordovaToast.show('Group successfully changed!', toastOptions.duration, toastOptions.position);\n      } catch (e) {\n        // do nothing because it fails on browser\n      } finally {\n        // change to today view after 2 seconds\n        $timeout(function () {\n          window.location.href = '#/app/today';\n        }, 2000);\n      }\n    });\n  };\n\n  $scope.addToCalendar = function () {\n    var appointments = [];\n    var calOptions = {};\n    // works on iOS only\n    calOptions.calendarName = 'Lukkari app calendar';\n    // android has id but no fucking idea what it does (1 is default)\n    // so great documentation 5/5\n    // https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin\n    calOptions.calendarId = 1;\n\n    // google may set some default reminders depending on settings\n    // https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin/issues/201\n    if ($scope.reminder.time !== 'null') {\n      calOptions.firstReminderMinutes = $scope.reminder.time;\n    } else {\n      calOptions.firstReminderMinutes = null;\n    }\n    calOptions.secondReminderMinutes = null;\n\n    var success = true;\n\n    function createEvent(element, index, array) {\n      var groups = '';\n      for (var i = 0; i < element.groups.length; i++) {\n        groups += element.groups[i] + ', ';\n      }\n\n      $cordovaCalendar.createEventWithOptions({\n        title: element.name,\n        location: element.room,\n        notes: 'Teacher(s): ' + element.teacher + '\\nGroup(s): ' + groups + '\\nCourse: ' + element.code,\n        startDate: element.startDay,\n        endDate: element.endDay,\n        firstReminderMinutes: calOptions.firstReminderMinutes,\n        secondReminderMinutes: calOptions.secondReminderMinutes,\n        calendarName: calOptions.calendarName,\n        calendarId: calOptions.calendarId\n        //calOptions: calOptions\n      }).then(function (result) {}, function (err) {\n        success = false;\n      });\n    }\n\n    Lessons.getDayToDay({\n      startDate: $scope.reminder.startDay,\n      endDate: $scope.reminder.endDay,\n      callback: function callback(response) {\n        $ionicPlatform.ready(function () {\n          response.lessons.forEach(createEvent);\n        });\n      }\n    });\n    var msg = '';\n    if (success) {\n      msg = 'Calendar events successfully added!';\n    } else {\n      msg = 'Failed to add calendar events!';\n    }\n\n    $cordovaToast.show(msg, toastOptions.duration, toastOptions.position);\n    console.log(msg);\n  };\n\n  // Set Motion\n  ionicMaterialMotion.ripple();\n\n  // Set Ink\n  ionicMaterialInk.displayEffect();\n}]);\n'use strict';\n\nangular.module('lukkari.controllers')\n// controller for today view\n.controller('TodayCtrl', ['$scope', '$ionicLoading', 'LocalStorage', '$ionicModal', 'MyDate', 'Lessons', 'ionicMaterialInk', 'ionicMaterialMotion', function ($scope, $ionicLoading, LocalStorage, $ionicModal, MyDate, Lessons, ionicMaterialInk, ionicMaterialMotion) {\n  $scope.groupInfo = {};\n  $scope.groupInfo.group = LocalStorage.get('groupName');\n  $scope.currentDay = new Date();\n\n  // Show new group modal when no group is set\n  $ionicModal.fromTemplateUrl('templates/newgroup.html', {\n    scope: $scope\n  }).then(function (modal) {\n    $scope.modal = modal;\n    if (!$scope.groupInfo.group) {\n      // open modal to set group name\n      $scope.modal.show();\n    }\n  });\n\n  $scope.closeGroupName = function () {\n    $scope.modal.hide();\n  };\n\n  function getAppointments() {\n    $ionicLoading.show({\n      template: loadingTemplate\n    });\n\n    Lessons.getDay({\n      day: $scope.currentDay,\n      callback: function callback(response) {\n        $ionicLoading.hide();\n        // Set Motion\n        //ionicMaterialMotion.blinds();\n        if (!response.success) {\n          console.error('ERROR');\n        } else {\n          $scope.lessons = response.dayLessons;\n        }\n      }\n    });\n  }\n\n  $scope.$on('ngLastRepeat.myList', function (e) {\n    ionicMaterialMotion.blinds();\n  });\n\n  // sets the group\n  $scope.setGroup = function () {\n    LocalStorage.set('groupName', $scope.groupInfo.group);\n    $scope.modal.hide();\n\n    Lessons.changeGroup({\n      groupName: $scope.groupInfo.group,\n      callback: function callback(success) {\n        if (success) {\n          getAppointments();\n        } else {\n          console.error('failed to change group name');\n        }\n      }\n    });\n  };\n\n  $scope.lessons = [];\n  if ($scope.groupInfo.group !== undefined) {\n    Lessons.changeGroup({\n      groupName: $scope.groupInfo.group,\n      callback: function callback(success) {\n        if (success) {\n          getAppointments();\n        } else {\n          console.error('failed to change group name');\n        }\n      }\n    });\n  }\n\n  // Moves a day forwards/backwards\n  $scope.moveDay = function (direction) {\n    $scope.currentDay = MyDate.getDayFromDay({\n      currentDay: $scope.currentDay,\n      offsetDays: direction\n    });\n\n    getAppointments();\n  };\n\n  // Set Ink\n  ionicMaterialInk.displayEffect();\n}]);\n'use strict';\n\nangular.module('lukkari.controllers')\n// controller for weekly view\n.controller('WeekCtrl', ['$scope', '$ionicLoading', '$ionicModal', 'LocalStorage', 'MyDate', 'Lessons', 'ionicMaterialInk', 'ionicMaterialMotion', function ($scope, $ionicLoading, $ionicModal, LocalStorage, MyDate, Lessons, ionicMaterialInk, ionicMaterialMotion) {\n  $scope.groupInfo = {};\n  $scope.groupInfo.group = LocalStorage.get('groupName');\n  $scope.currentDate = MyDate.getMonday(new Date());\n  $scope.endDate = MyDate.getDayFromDay({\n    currentDay: $scope.currentDate,\n    offsetDays: 4\n  });\n\n  // Create modal for new group if no group name is set\n  if (!$scope.groupInfo.group) {\n    $ionicModal.fromTemplateUrl('templates/newgroup.html', {\n      scope: $scope\n    }).then(function (modal) {\n      $scope.modal = modal;\n      // open modal to set group name\n      $scope.modal.show();\n    });\n  }\n\n  // closes the group name dialog\n  $scope.closeGroupName = function () {\n    $scope.modal.hide();\n  };\n\n  // returns all of the appointments\n  function getAppointments() {\n    // show the loading window\n    $ionicLoading.show({\n      template: loadingTemplate\n    });\n    // get all the appointments\n    Lessons.getWeek({\n      day: $scope.currentDate,\n      callback: function callback(response) {\n        $ionicLoading.hide();\n        //ionicMaterialMotion.ripple();\n\n        if (!response.success) {\n          console.error('ERROR');\n        } else {\n          var allLessons = response.weekLessons;\n          $scope.days = [];\n          for (var i = 0; i < 5; i++) {\n            var day = {};\n            // get mon-fri\n            day.date = MyDate.getDayFromDay({\n              currentDay: $scope.currentDate,\n              offsetDays: i\n            });\n            day.lessons = [];\n            var lessonsLength = allLessons.length;\n            for (var j = 0; j < lessonsLength; j++) {\n              var lesson = allLessons[j];\n              // if same day push into the day array\n              if (lesson.startDay.toDateString() === day.date.toDateString()) {\n                day.lessons.push(lesson);\n              }\n            }\n            $scope.days.push(day);\n          }\n        }\n      }\n    });\n    // hide the loading after done\n    $ionicLoading.hide();\n  }\n\n  $scope.$on('ngLastRepeat.myList', function (e) {\n    ionicMaterialMotion.ripple();\n  });\n\n  // sets the group name\n  $scope.setGroup = function () {\n    LocalStorage.set('groupName', $scope.groupInfo.group);\n    $scope.modal.hide();\n\n    Lessons.changeGroup({\n      groupName: $scope.groupInfo.group,\n      callback: function callback(success) {\n        if (success) {\n          getAppointments();\n        } else {\n          console.error('failed to change group name');\n        }\n      }\n    });\n  };\n\n  $scope.lessons = [];\n  if ($scope.groupInfo.group !== undefined) {\n    Lessons.changeGroup({\n      groupName: $scope.groupInfo.group,\n      callback: function callback(success) {\n        if (success) {\n          getAppointments();\n        } else {\n          console.error('failed to change group name');\n        }\n      }\n    });\n  }\n\n  // moves a week forwards/backwards\n  $scope.moveWeek = function (direction) {\n    $scope.currentDate = MyDate.getDayFromDay({\n      currentDay: $scope.currentDate,\n      offsetDays: 7 * direction\n    });\n    $scope.endDate = MyDate.getDayFromDay({\n      currentDay: $scope.currentDate,\n      offsetDays: 4\n    });\n\n    getAppointments();\n  };\n\n  // Set Ink\n  ionicMaterialInk.displayEffect();\n}]);","angular.module('lukkari', ['ionic', 'lukkari.controllers',\r\n  'lukkari.services', 'lukkari.directives', 'ionic-datepicker',\r\n  'ionic-material', 'angularXml2json'\r\n])\r\n.run(['$ionicPlatform',\r\nfunction($ionicPlatform) {\r\n  $ionicPlatform.ready(function() {\r\n    // Hide the accessory bar by default (remove this to show the accessory bar above the keyboard\r\n    // for form inputs)\r\n    if (window.cordova && window.cordova.plugins.Keyboard) {\r\n      cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);\r\n      cordova.plugins.Keyboard.disableScroll(true);\r\n\r\n    }\r\n    if (window.StatusBar) {\r\n      // org.apache.cordova.statusbar required\r\n      StatusBar.styleDefault();\r\n    }\r\n  });\r\n}])\r\n\r\n// http://blog.ionic.io/handling-cors-issues-in-ionic/\r\n.constant('ApiEndpoint', {\r\n  url: 'http://localhost:8100/api'\r\n})\r\n\r\n.constant('LunchEndPoint', {\r\n  url: 'http://localhost:8100/lunch'\r\n})\r\n\r\n// menuContent-view is presented on the main view.\r\n.config(['$stateProvider', '$urlRouterProvider',\r\n function($stateProvider, $urlRouterProvider) {\r\n  $stateProvider\r\n    .state('app', {\r\n      url: '/app',\r\n      abstract: true,\r\n      templateUrl: 'templates/menu.html',\r\n      controller: 'LukkariCtrl'\r\n    })\r\n    .state('app.search', {\r\n      url: '/search',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/search.html',\r\n          controller: 'SearchCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.settings', {\r\n      url: '/settings',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/settings.html',\r\n          controller: 'SettingsCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.todayLesson', {\r\n      url: '/today/:id',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/lesson.html',\r\n          controller: 'LessonCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.today', {\r\n      url: '/today',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/today.html',\r\n          controller: 'TodayCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.lesson', {\r\n      url: '/week/:id',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/lesson.html',\r\n          controller: 'LessonCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.week', {\r\n      url: '/week',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/week.html',\r\n          controller: 'WeekCtrl'\r\n        }\r\n      }\r\n    })\r\n    .state('app.lunch', {\r\n      url: '/lunch',\r\n      views: {\r\n        'menuContent': {\r\n          templateUrl: 'templates/lunch.html',\r\n          controller: 'LunchCtrl'\r\n        }\r\n      }\r\n    });\r\n  // if none of the above states are matched, use this as the fallback\r\n  $urlRouterProvider.otherwise('/app/today');\r\n}]);\r\n\r\nangular.module('lukkari.services', []);\r\nangular.module('lukkari.controllers', ['ngCordova']);\r\nconst loadingTemplate = '<div class=\"loader\"><svg class=\"circular\">' +\r\n  '<circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\"' +\r\n  ' stroke-miterlimit=\"10\"/></svg></div>';\r\nangular.module('lukkari.directives', []);\r\n","angular.module('lukkari.services')\n  .factory('FoodService', ['$http', 'LunchEndPoint', 'ngXml2json',\n    function($http, LunchEndPoint, ngXml2json) {\n      var lunches = [];\n\n      function parseLunch(element, index, array) {\n        var i;\n        var j;\n        var lunch = {};\n        // get date\n        lunch.date = new Date(element.div[0].span.content[0]);\n        // get dishes\n        lunch.dishes = [];\n        // remove 3 from length to ignore evening foods\n        var length = element.div[1].div.length - 3;\n        for (i = 0; i < length; i++) {\n          var dish = {};\n          dish.pricegroups = [];\n          dish.allergies = [];\n          dish.name = element.div[1].div[i].div.div.ul.li.div.div\n            .div[0].div.div.content;\n          if (dish.name.includes('Ravintola avoinna')) {\n            continue;\n          }\n          // get pricing info\n          // var length2;\r\n          // try {\r\n          //   length2 = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\r\n          //     .div.div.div.length;\r\n          // } catch (e) {\r\n          //   length2 = 0;\r\n          // }\r\n          //\r\n          // for (j = 0; j < length2; j++) {\r\n          //   var pricegroup = {};\r\n          //   try {\r\n          //     pricegroup.group = element.div[1].div[i].div.div.ul.li.div.div.div[\r\n          //       1].div.div.div.div[j].div[0].div.div.p;\r\n          //   } catch (e) {\r\n          //     pricegroup.group = 'N/A';\r\n          //   }\r\n          //   try {\r\n          //     pricegroup.price = element.div[1].div[i].div.div.ul.li.div.div.div[\r\n          //       1].div.div.div.div[j].div[1].div.div.content;\r\n          //   } catch (e) {\r\n          //     pricegroup.price = '';\r\n          //   }\r\n          //\r\n          //   dish.pricegroups.push(pricegroup);\r\n          // }\r\n          // // var pricegroup = {};\r\n          // // pricegroup.group = element.div[1].div[i].div.div.ul.li.div.div.div[\r\n          // //   1].div.div.div.div[j].div.div.div.p;\r\n          // // pricegroup.price = element.div[1].div[i].div.div.ul.li.div.div.div[\r\n          // //   1].div.div.div.div[j].div.div.div.p;\r\n          //\r\n          // // get allergy info\r\n          // var length3 = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\r\n          //   .div.length;\r\n          // for (j = 0; j < length3; j++) {\r\n          //   var allergy = element.div[1].div[i].div.div.ul.li.div.div.div[1].div\r\n          //     .div[j].div.div[0].div.div.p;\r\n          //   dish.allergies.push(allergy);\r\n          // }\r\n          lunch.dishes.push(dish);\n        }\n        lunches.push(lunch);\n      }\n\n      function get({\n        callback\n      }) {\n        if (lunches.length > 0) {\n          callback(lunches);\n        } else {\n          $http({\n            method: 'GET',\n            url: \"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fcampusravita.fi%2Fruokalista%22%20and%0A%20%20%20%20%20%20xpath%3D'%2F%2Fdiv%5B%40class%3D%22view-grouping%22%5D'&format=json&diagnostics=true&callback=\"\n          }).then(\n            function successCallback(response) {\n              var data = response.data.query.results.div;\n              data.forEach(parseLunch);\n              callback(lunches);\n            },\n            function errorCallback(response) {});\n        }\n      }\n\n      return {\n        get: get\n      };\n    }\n  ]);\r\n","angular.module('lukkari.services')\n  .factory('Lessons', ['$http', 'ApiEndpoint', 'MyDate',\n    function($http, ApiEndpoint, MyDate) {\n      var lessons = [];\n      var savedGroupName = '';\n\n      function parseLesson(element, index, array) {\n        var lesson = {};\n        lesson.id = index;\n        lesson.startDay = new Date(element.startDate);\n        lesson.endDay = new Date(element.endDate);\n        lesson.groups = [];\n        // parse the resources array\n        var {\n          resources\n        } = element;\n        resources.forEach(function(resource, index, array) {\n          switch (resource.type) {\n            case 'realization':\n              lesson.code = resource.code;\n              lesson.name = resource.name;\n              break;\n            case 'room':\n              lesson.room = resource.code;\n              lesson.roomInfo = resource.parent.name;\n              break;\n            case 'student_group':\n              lesson.groups.push(resource.code);\n              break;\n          }\n        });\n        lessons.push(lesson);\n      }\n\n      function get(callback) {\n        var data = {\n          studentGroup: [savedGroupName]\n        };\n        var apiKey = 'Wu47zzKEPa7agvin47f5';\n        var url = ApiEndpoint.url + '/reservation/search' +\n          '?apiKey=' + apiKey;\n        $http({\n          method: 'POST',\n          url: url,\n          data: data,\n          withCredentials: true,\n          headers: {\n            'authorization': 'Basic V3U0N3p6S0VQYTdhZ3ZpbjQ3ZjU6',\n            'accept-language': 'fi',\n            'content-type': 'application/json',\n            'cache-control': 'no-cache'\n          }\n        }).success(function(data, status, headers, config) {\n          console.log('success');\n          lessons = [];\n          data.reservations.forEach(parseLesson);\n          callback({\n            success: false\n          });\n        }).error(function(data, status, headers, config) {\n          console.log('failure');\n          callback({\n            success: false\n          });\n        });\n      }\n\n      // private get method that just saves lessons\n      // change group name method that changes group anme and uses private get method\n      function changeGroup({\n        groupName, callback\n      }) {\n        savedGroupName = groupName.toUpperCase();\n        get(function(result) {\n          callback(result);\n        });\n      }\n\n      // get day method that returns one day's lessons using date\n      function getDay({\n        callback, day\n      }) {\n        if (!day || !day instanceof Date) {\n          console.error('Error in date!');\n          callback({\n            success: false\n          });\n        } else {\n          var dayLessons = [];\n          lessons.forEach(function(lesson, index, array) {\n            var date = lesson.startDay;\n            if (date.getDate() === day.getDate() &&\n              date.getMonth() === day.getMonth()) {\n              dayLessons.push(lesson);\n            }\n          });\n          callback({\n            success: true,\n            dayLessons\n          });\n        }\n      }\n\n      // get week method that returns one week's lessons using startDate and week offset\n      function getWeek({\n        callback, day\n      }) {\n        var weekLessons = [];\n        var startDate = new Date(day.getFullYear(), day.getMonth(),\n          day.getDate());\n        var endDate = MyDate.getDayFromDay({\n          currentDay: day,\n          offsetDays: 5\n        });\n        lessons.forEach(function(lesson, index, array) {\n          if (lesson.startDay >= startDate && lesson.startDay <= endDate) {\n            weekLessons.push(lesson);\n          }\n        });\n        callback({\n          success: true,\n          weekLessons\n        });\n      }\n\n      //get day to day method that returns all appointments from day a to day b\n      function getDayToDay({\n        callback, startDate, endDate\n      }) {\n        var correctEndDate = MyDate.getDayFromDay({\n          currentDay: endDate,\n          offsetDays: 1\n        });\n        var retLessons = [];\n        lessons.forEach(function(lesson, index, array) {\n          if (lesson.startDay >= startDate && lesson.startDay <=\n            correctEndDate) {\n            retLessons.push(lesson);\n          }\n        });\n        callback({\n          success: true,\n          lessons: retLessons\n        });\n      }\n\n      function getLesson(id) {\n        return lessons[id];\n      }\n\n      return {\n        changeGroup: changeGroup,\n        getDay: getDay,\n        getWeek: getWeek,\n        getDayToDay: getDayToDay,\n        getLesson: getLesson\n      };\n    }\n  ]);\n","angular.module('lukkari.services')\n  .factory('LocalStorage', [function() {\n    function get(name) {\n      return window.localStorage.getItem(name);\n    }\n\n    function set(name, value) {\n      return window.localStorage.setItem(name, value);\n    }\n\n    return {\n      get: get,\n      set: set\n    };\n  }]);\n","angular.module('lukkari.services')\n  .factory('MyDate', [function() {\n    var DAY_IN_MILLISECONDS = 86400000;\n\n    // returns the monday of the week date object of the given date\n    function getMonday(d) {\n      d = new Date(d);\n      var day = d.getDay();\n      var diff = d.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\n      return new Date(d.setDate(diff));\n    }\n\n    function getLocaleDate({\n      day, years\n    }) {\n      var options = {\n        //weekday: 'long',\n        month: 'numeric',\n        day: 'numeric'\n      };\n      if (typeof years === 'boolean' && years) {\n        options.year = 'numeric';\n      }\n      return new Intl.DateTimeFormat('fi-FI', options).format(day);\n    }\n\n    function getDayFromDay({\n      currentDay, offsetDays\n    }) {\n      var day = currentDay.getTime();\n      // add desired amount of days to the millisecs\n      day += offsetDays * DAY_IN_MILLISECONDS;\n      // create Date object and set it's time to the millisecs\n      var date = new Date();\n      date.setTime(day);\n      return date;\n    }\n\n    // returns a day that is offset from today\n    function getDayFromToday(offsetDays) {\n      // today in millisecs since the beginning of time (UNIX time)\n      var day = Date.now();\n      // add desired amount of days to the millisecs\n      day += offsetDays * DAY_IN_MILLISECONDS;\n      // create Date object and set it's time to the millisecs\n      return new Date(day);\n    }\n\n    return {\n      getMonday: getMonday,\n      getDayFromToday: getDayFromToday,\n      getLocaleDate: getLocaleDate,\n      getDayFromDay: getDayFromDay\n    };\n  }]);\n","angular.module('lukkari.directives')\n  .directive('date', function() {\n    return {\n      template: '{{day.date.toLocaleDateString(\"fi-FI\",' +\n        ' {weekday: \"short\", day: \"numeric\", month:\"numeric\"})}}'\n    };\n  });\n","angular.module('lukkari.directives')\n  .directive('ngLastRepeat', function($timeout) {\n    return {\n      restrict: 'A',\n      link: function(scope, element, attr) {\n        if (scope.$last === true) {\n          $timeout(function() {\n            scope.$emit('ngLastRepeat' + (attr.ngLastRepeat ? '.' +\n              attr.ngLastRepeat : ''));\n          });\n        }\n      }\n    };\n  });\n","angular.module('lukkari.directives')\n  .directive('timeRange', function() {\n    return {\n      template: '{{lesson.startDay.toLocaleTimeString' +\n        '(\"fi-FI\", {hour:\"numeric\", minute:\"numeric\"})}}' +\n        ' â€” ' +\n        '{{lesson.endDay.toLocaleTimeString' +\n        '(\"fi-FI\", {hour:\"numeric\", minute:\"numeric\"})}}'\n    };\n  });\n","angular.module('lukkari.controllers')\n  // controller for single appointment view\n  .controller('LessonCtrl', ['$scope', '$ionicLoading',\n    '$stateParams', 'Lessons', 'ionicMaterialInk', 'ionicMaterialMotion',\n    function($scope, $ionicLoading, $stateParams, Lessons, ionicMaterialInk,\n      ionicMaterialMotion) {\n      $scope.lesson = Lessons.getLesson($stateParams.id);\n    }\n  ]);\n","angular.module('lukkari.controllers')\n  .controller('LukkariCtrl', ['$scope',\n    function($scope) {}\n  ]);\n","angular.module('lukkari.controllers')\n  .controller('LunchCtrl', ['$scope', 'FoodService', 'ionicMaterialInk',\n    'ionicMaterialMotion', '$ionicLoading',\n    function($scope, FoodService, ionicMaterialInk, ionicMaterialMotion,\n      $ionicLoading) {\n      $ionicLoading.show({\n        template: '<div class=\"loader\"><svg class=\"circular\"><circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"/></svg></div>'\n      });\n      FoodService.get({\n        callback: function(lunches) {\n          $scope.lunches = lunches;\n          $ionicLoading.hide();\n        }\n      });\n\n      $scope.$on('ngLastRepeat.myList', function(e) {\n        ionicMaterialMotion.ripple();\n      });\n\n      // Set Ink\n      ionicMaterialInk.displayEffect();\n    }\n  ]);\n","angular.module('lukkari.controllers')\n  // TODO\n  .controller('SearchCtrl', ['$scope', 'LocalStorage',\n    function($scope, LocalStorage) {}\n  ]);\n","angular.module('lukkari.controllers')\n  .controller('SettingsCtrl', ['$scope', 'LocalStorage',\n    '$cordovaToast', '$ionicPlatform', '$timeout', '$cordovaCalendar',\n    'Lessons', 'MyDate', 'ionicMaterialInk', 'ionicMaterialMotion',\n    function($scope, LocalStorage, $cordovaToast, $ionicPlatform,\n      $timeout, $cordovaCalendar, Lessons, MyDate, ionicMaterialInk,\n      ionicMaterialMotion) {\n      $scope.groupInfo = {};\n      $scope.reminder = {};\n      $scope.reminder.startDay = new Date();\n      $scope.reminder.endDay = new Date();\n\n      var toastOptions = {\n        duration: 'long',\n        position: 'center'\n      };\n\n      function datePickerCallback(val) {\n        if (typeof(val) === 'undefined') {\n          //console.log('No date selected');\n        } else {\n          //console.log('Selected date is : ', val);\n          $scope.reminder.startDay = val;\n          $scope.datepickerObject.inputDate = val;\n        }\n      }\n\n      function datePickerCallback2(val) {\n        if (typeof(val) === 'undefined') {\n          //console.log('No date selected');\n        } else {\n          //console.log('Selected date is : ', val);\n          $scope.reminder.endDay = val;\n          $scope.datepickerObject2.inputDate = val;\n        }\n      }\n\n      // https://github.com/rajeshwarpatlolla/ionic-datepicker\n      $scope.datepickerObject = {\n        titleLabel: 'Select Start Date', //Optional\n        todayLabel: 'Today', //Optional\n        closeLabel: '<span class=\"icon ion-android-close\"></span>', //Optional\n        setLabel: '<span class=\"icon ion-android-done\"></span>', //Optional\n        setButtonType: 'button-positive', //Optional\n        todayButtonType: 'button-stable', //Optional\n        closeButtonType: 'button-assertive', //Optional\n        inputDate: $scope.reminder.startDay, //Optional\n        mondayFirst: true, //Optional\n        //disabledDates: disabledDates, //Optional\n        //weekDaysList: weekDaysList, //Optional\n        //monthList: monthList, //Optional\n        templateType: 'popup', //Optional\n        showTodayButton: 'true', //Optional\n        modalHeaderColor: 'bar-stable', //Optional\n        modalFooterColor: 'bar-stable', //Optional\n        from: new Date(), //Optional\n        //to: new Date(2018, 8, 25), //Optional\n        callback: function(val) { //Mandatory\n          datePickerCallback(val);\n        },\n        dateFormat: 'dd-MM-yyyy', //Optional\n        closeOnSelect: true, //Optional\n      };\n\n      $scope.datepickerObject2 = {\n        titleLabel: 'Select End Date', //Optional\n        todayLabel: 'Today', //Optional\n        closeLabel: '<span class=\"icon ion-android-close\"></span>', //Optional\n        setLabel: '<span class=\"icon ion-android-done\"></span>', //Optional\n        setButtonType: 'button-positive', //Optional\n        todayButtonType: 'button-stable', //Optional\n        closeButtonType: 'button-assertive', //Optional\n        inputDate: $scope.reminder.endDay, //Optional\n        mondayFirst: true, //Optional\n        //disabledDates: disabledDates, //Optional\n        //weekDaysList: weekDaysList, //Optional\n        //monthList: monthList, //Optional\n        templateType: 'popup', //Optional\n        showTodayButton: false, //Optional\n        modalHeaderColor: 'bar-positive', //Optional\n        modalFooterColor: 'bar-positive', //Optional\n        from: new Date(), //Optional\n        //to: new Date(2018, 8, 25), //Optional\n        callback: function(val) { //Mandatory\n          datePickerCallback2(val);\n        },\n        dateFormat: 'dd-MM-yyyy', //Optional\n        closeOnSelect: true, //Optional\n      };\n\n      $scope.reminder.time = 'null';\n      $scope.groupInfo.group = LocalStorage.get('groupName');\n      if (!$scope.groupInfo.group) {\n        $scope.groupInfo.group = '';\n      }\n\n      $scope.changeGroup = function() {\n        LocalStorage.set('groupName', $scope.groupInfo.group);\n        // show toast that change was successful\n        $ionicPlatform.ready(function() {\n          try {\n            $cordovaToast.show('Group successfully changed!',\n              toastOptions.duration,\n              toastOptions.position);\n          } catch (e) {\n            // do nothing because it fails on browser\n          } finally {\n            // change to today view after 2 seconds\n            $timeout(function() {\n              window.location.href = '#/app/today';\n            }, 2000);\n          }\n        });\n      };\n\n      $scope.addToCalendar = function() {\n        var appointments = [];\n        var calOptions = {};\n        // works on iOS only\n        calOptions.calendarName = 'Lukkari app calendar';\n        // android has id but no fucking idea what it does (1 is default)\n        // so great documentation 5/5\n        // https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin\n        calOptions.calendarId = 1;\n\n        // google may set some default reminders depending on settings\n        // https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin/issues/201\n        if ($scope.reminder.time !== 'null') {\n          calOptions.firstReminderMinutes = $scope.reminder.time;\n        } else {\n          calOptions.firstReminderMinutes = null;\n        }\n        calOptions.secondReminderMinutes = null;\n\n        var success = true;\n\n        function createEvent(element, index, array) {\n          var groups = '';\n          for (var i = 0; i < element.groups.length; i++) {\n            groups += element.groups[i] + ', ';\n          }\n\n          $cordovaCalendar.createEventWithOptions({\n            title: element.name,\n            location: element.room,\n            notes: 'Teacher(s): ' + element.teacher +\n              '\\nGroup(s): ' + groups +\n              '\\nCourse: ' + element.code,\n            startDate: element.startDay,\n            endDate: element.endDay,\n            firstReminderMinutes: calOptions.firstReminderMinutes,\n            secondReminderMinutes: calOptions.secondReminderMinutes,\n            calendarName: calOptions.calendarName,\n            calendarId: calOptions.calendarId\n              //calOptions: calOptions\n          }).then(function(result) {}, function(err) {\n            success = false;\n          });\n        }\n\n        Lessons.getDayToDay({\n          startDate: $scope.reminder.startDay,\n          endDate: $scope.reminder.endDay,\n          callback: function(response) {\n            $ionicPlatform.ready(function() {\n              response.lessons.forEach(createEvent);\n            });\n          }\n        });\n        var msg = '';\n        if (success) {\n          msg = 'Calendar events successfully added!';\n        } else {\n          msg = 'Failed to add calendar events!';\n        }\n\n        $cordovaToast.show(msg,\n          toastOptions.duration,\n          toastOptions.position);\n        console.log(msg);\n      };\n\n      // Set Motion\n      ionicMaterialMotion.ripple();\n\n      // Set Ink\n      ionicMaterialInk.displayEffect();\n    }\n  ]);\n","angular.module('lukkari.controllers')\n// controller for today view\n.controller('TodayCtrl', ['$scope', '$ionicLoading',\n  'LocalStorage', '$ionicModal', 'MyDate', 'Lessons', 'ionicMaterialInk',\n  'ionicMaterialMotion',\n  function($scope, $ionicLoading, LocalStorage, $ionicModal, MyDate,\n    Lessons, ionicMaterialInk, ionicMaterialMotion) {\n    $scope.groupInfo = {};\n    $scope.groupInfo.group = LocalStorage.get('groupName');\n    $scope.currentDay = new Date();\n\n    // Show new group modal when no group is set\n    $ionicModal.fromTemplateUrl('templates/newgroup.html', {\n      scope: $scope\n    }).then(function(modal) {\n      $scope.modal = modal;\n      if (!$scope.groupInfo.group) {\n        // open modal to set group name\n        $scope.modal.show();\n      }\n    });\n\n    $scope.closeGroupName = function() {\n      $scope.modal.hide();\n    };\n\n    function getAppointments() {\n      $ionicLoading.show({\n        template: loadingTemplate\n      });\n\n      Lessons.getDay({\n        day: $scope.currentDay,\n        callback: function(response) {\n          $ionicLoading.hide();\n          // Set Motion\n          //ionicMaterialMotion.blinds();\n          if (!response.success) {\n            console.error('ERROR');\n          } else {\n            $scope.lessons = response.dayLessons;\n          }\n        }\n      });\n    }\n\n    $scope.$on('ngLastRepeat.myList', function(e) {\n      ionicMaterialMotion.blinds();\n    });\n\n    // sets the group\n    $scope.setGroup = function() {\n      LocalStorage.set('groupName', $scope.groupInfo.group);\n      $scope.modal.hide();\n\n      Lessons.changeGroup({\n        groupName: $scope.groupInfo.group,\n        callback: function(success) {\n          if (success) {\n            getAppointments();\n          } else {\n            console.error('failed to change group name');\n          }\n        }\n      });\n    };\n\n    $scope.lessons = [];\n    if ($scope.groupInfo.group !== undefined) {\n      Lessons.changeGroup({\n        groupName: $scope.groupInfo.group,\n        callback: function(success) {\n          if (success) {\n            getAppointments();\n          } else {\n            console.error('failed to change group name');\n          }\n        }\n      });\n    }\n\n    // Moves a day forwards/backwards\n    $scope.moveDay = function(direction) {\n      $scope.currentDay = MyDate.getDayFromDay({\n        currentDay: $scope.currentDay,\n        offsetDays: direction\n      });\n\n      getAppointments();\n    };\n\n    // Set Ink\n    ionicMaterialInk.displayEffect();\n  }\n]);\n","angular.module('lukkari.controllers')\n  // controller for weekly view\n  .controller('WeekCtrl', ['$scope', '$ionicLoading',\n    '$ionicModal', 'LocalStorage', 'MyDate', 'Lessons', 'ionicMaterialInk',\n    'ionicMaterialMotion',\n    function($scope, $ionicLoading, $ionicModal, LocalStorage, MyDate,\n      Lessons, ionicMaterialInk, ionicMaterialMotion) {\n      $scope.groupInfo = {};\n      $scope.groupInfo.group = LocalStorage.get('groupName');\n      $scope.currentDate = MyDate.getMonday(new Date());\n      $scope.endDate = MyDate.getDayFromDay({\n        currentDay: $scope.currentDate,\n        offsetDays: 4\n      });\n\n      // Create modal for new group if no group name is set\n      if (!$scope.groupInfo.group) {\n        $ionicModal.fromTemplateUrl('templates/newgroup.html', {\n          scope: $scope\n        }).then(function(modal) {\n          $scope.modal = modal;\n          // open modal to set group name\n          $scope.modal.show();\n        });\n      }\n\n      // closes the group name dialog\n      $scope.closeGroupName = function() {\n        $scope.modal.hide();\n      };\n\n      // returns all of the appointments\n      function getAppointments() {\n        // show the loading window\n        $ionicLoading.show({\n          template: loadingTemplate\n        });\n        // get all the appointments\n        Lessons.getWeek({\n          day: $scope.currentDate,\n          callback: function(response) {\n            $ionicLoading.hide();\n            //ionicMaterialMotion.ripple();\n\n            if (!response.success) {\n              console.error('ERROR');\n            } else {\n              var allLessons = response.weekLessons;\n              $scope.days = [];\n              for (var i = 0; i < 5; i++) {\n                var day = {};\n                // get mon-fri\n                day.date = MyDate.getDayFromDay({\n                  currentDay: $scope.currentDate,\n                  offsetDays: i\n                });\n                day.lessons = [];\n                var lessonsLength = allLessons.length;\n                for (var j = 0; j < lessonsLength; j++) {\n                  var lesson = allLessons[j];\n                  // if same day push into the day array\n                  if (lesson.startDay.toDateString() ===\n                    day.date.toDateString()) {\n                    day.lessons.push(lesson);\n                  }\n                }\n                $scope.days.push(day);\n              }\n            }\n          }\n        });\n        // hide the loading after done\n        $ionicLoading.hide();\n      }\n\n      $scope.$on('ngLastRepeat.myList', function(e) {\n        ionicMaterialMotion.ripple();\n      });\n\n      // sets the group name\n      $scope.setGroup = function() {\n        LocalStorage.set('groupName', $scope.groupInfo.group);\n        $scope.modal.hide();\n\n        Lessons.changeGroup({\n          groupName: $scope.groupInfo.group,\n          callback: function(success) {\n            if (success) {\n              getAppointments();\n            } else {\n              console.error('failed to change group name');\n            }\n          }\n        });\n      };\n\n      $scope.lessons = [];\n      if ($scope.groupInfo.group !== undefined) {\n        Lessons.changeGroup({\n          groupName: $scope.groupInfo.group,\n          callback: function(success) {\n            if (success) {\n              getAppointments();\n            } else {\n              console.error('failed to change group name');\n            }\n          }\n        });\n      }\n\n      // moves a week forwards/backwards\n      $scope.moveWeek = function(direction) {\n        $scope.currentDate = MyDate.getDayFromDay({\n          currentDay: $scope.currentDate,\n          offsetDays: (7 * direction)\n        });\n        $scope.endDate = MyDate.getDayFromDay({\n          currentDay: $scope.currentDate,\n          offsetDays: 4\n        });\n\n        getAppointments();\n      };\n\n      // Set Ink\n      ionicMaterialInk.displayEffect();\n    }\n  ]);\n"],"sourceRoot":"/source/"}